{"version":3,"sources":["js/Canvas.js","js/Bullet.js","js/Block.js","js/utils.js","js/Blocks.js","js/Hero.js","js/Player.js","js/Draw.js","js/Keydown.js","js/Controls.js","js/Collisions.js","js/main.js"],"names":["CANVAS_WIDTH","CANVAS_HEIGHT","canvas","document","getElementById","width","height","ctx","getContext","Bullet","bullet","w","h","color","yVelocity","speed","active","draw","fillStyle","beginPath","arc","x","y","Math","PI","fill","inBounds","update","Block","block","points","floor","random","fillRect","font","text","value","toFixed","textMeasures","measureText","fillText","alive","rand","collides","min","max","a","b","Blocks","data","init","n","blockWidth","i","push","forEach","filter","Hero","bullets","shooting","shoot","setInterval","moveLeft","moveRight","player","score","Draw","keydown","left","right","space","addEventListeners","handleControls","e","keyCode","type","window","addEventListener","Collisions","setup","handle","clearRect","background","loop","requestAnimationFrame"],"mappings":"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","file":"29838abd20c8d1086c78a897ebbc7895.map","sourcesContent":["const CANVAS_WIDTH = 640, CANVAS_HEIGHT = 640;\n\nlet canvas = document.getElementById('canvas');\ncanvas.width = CANVAS_WIDTH;\ncanvas.height = CANVAS_HEIGHT;\nconst ctx = canvas.getContext('2d');\n\nexport {CANVAS_WIDTH, CANVAS_HEIGHT, ctx};","import {ctx} from './Canvas';\n\nexport default function Bullet(bullet) {\n    \n    bullet.w = 10;\n    bullet.h = 10;\n    bullet.color = \"white\";\n    bullet.yVelocity = -bullet.speed;\n    bullet.active = true;\n    \n    bullet.draw = function() {\n        ctx.fillStyle = bullet.color;\n        ctx.beginPath();\n        ctx.arc(bullet.x, bullet.y, bullet.w / 2, 0, Math.PI * 2);\n        ctx.fill();\n    };\n    \n    bullet.inBounds = function() {\n        return bullet.y >= 0;\n    };\n\n    bullet.update = function() {\n        bullet.y += bullet.yVelocity;\n        bullet.active = bullet.active && bullet.inBounds();              \n    };\n\n    return bullet;\n}","import {ctx} from './Canvas';\n\nexport default function Block(block = {}) {\n    block.w = 100;\n    block.h = 50;    \n    block.points = Math.floor(Math.random() * 15000000) + 5000000;\n    block.active = true;\n\n    block.draw = function() {\n        ctx.fillStyle = block.color;\n        ctx.fillRect(block.x, block.y, block.w, block.h);\n        ctx.font = \"20px Arial\";\n        let text = {\n            value: `${+(block.points / 1000000).toFixed(1)}M`,\n            color: \"black\",\n            textMeasures: ctx.measureText(this.value),\n            x: (block.x + block.w / 3),\n            y: (block.y + block.h / 2)\n        };            \n        ctx.fillStyle = text.color;\n        ctx.fillText(text.value, text.x, text.y);\n    };\n\n    block.alive = function() {\n        return block.points > 1000000;\n    };\n\n    block.update = function() {        \n        block.active = block.active && block.alive();\n    }\n\n    return block;\n}","export function rand(min, max) {\n    return Math.floor(Math.random() * max) + min;\n}\n\nexport function collides(a, b) {\n    return a.x < b.x + b.w &&\n            a.x + a.w > b.x &&\n            a.y < b.y + b.h &&\n            a.y + a.h > b.h;\n}","import {CANVAS_WIDTH} from './Canvas';\nimport Block from './Block';\nimport {rand} from './utils';\n\nlet Blocks = {\n    data: [],    \n    init: () => {\n        let n = 6;\n        let blockWidth = CANVAS_WIDTH / n;\n\n        for (let i = 0; i < n; i++) {\n            Blocks.data.push(new Block({\n                color: `rgb(${rand(0,255)}, ${rand(0,255)}, ${rand(0,255)})`,\n                w: blockWidth,\n                x: blockWidth * i + 1,\n                y: 50\n            }));\n        }\n    },\n    update: () => {\n        Blocks.data.forEach(block => block.update());\n        Blocks.data = Blocks.data.filter(block => block.active);\n    },\n    draw: () => {\n        Blocks.data.forEach(block => block.draw());\n    }\n}\n\nexport default Blocks;","import {CANVAS_WIDTH, CANVAS_HEIGHT, ctx} from './Canvas';\nimport Bullet from './Bullet';\n\nlet Hero = {\n    color: \"red\",\n    w: 100,\n    h: 100,\n    x: CANVAS_WIDTH / 2,\n    y: CANVAS_HEIGHT - 110,\n    speed: 10,\n    bullets: [],\n    shooting: false,\n    draw: function() {\n        ctx.fillStyle = this.color;\n        ctx.fillRect(this.x, this.y, this.w, this.h);\n    },\n    update: function() {\n        this.bullets.forEach(bullet => bullet.update());\n        this.bullets = this.bullets.filter( bullet => bullet.active);\n    },\n    shoot: function() {\n        if(this.shooting) return;\n        this.shooting = setInterval(() => {\n            this.bullets.push(new Bullet({\n                speed: 5,\n                x: this.x + this.w/2,\n                y: this.y\n            }));\n        }, 700);\n    },\n    moveLeft: function() {\n        if(this.x > 0) {\n            this.x -= this.speed;\n        }\n    },\n    moveRight: function() {\n        if(this.x < CANVAS_WIDTH - this.w) {\n            this.x += this.speed;\n        }\n    },\n    inBounds: function() {\n        return this.x > 0 && this.x < CANVAS_WIDTH - this.w;\n    }\n};\n\nexport default Hero;","let player = {\n    score: 0\n}\n\nexport default player;","import {CANVAS_WIDTH, CANVAS_HEIGHT, ctx} from './Canvas';\nimport player from './Player';\n\nexport default class Draw {\n    \n    static background() {\n        ctx.fillStyle = \"black\";\n        ctx.fillRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);\n    }\n\n    static score() {\n        ctx.fillStyle = \"white\";\n        ctx.font = \"Arial 20px\";\n        ctx.fillText(`Score: ${+(player.score / 1000000).toFixed(1)}M`, 20, 50);\n    }\n\n}","let keydown = {\n    left: false,\n    right: false,\n    space: false\n}\n\nexport default keydown;","import keydown from './Keydown';\n\nfunction handleControls(e) {\n    if(e.keyCode === 37) keydown.left = e.type === \"keydown\" ? true : false;    \n    if(e.keyCode === 39) keydown.right = e.type === \"keydown\" ? true : false;\n    if(e.keyCode === 32) keydown.space = e.type === \"keydown\" ? true : false;\n}\n\nexport function addEventListeners() {\n    window.addEventListener('keydown', handleControls);\n    window.addEventListener('keyup', handleControls);\n}","import Hero from './Hero';\nimport Blocks from './Blocks';\nimport player from './Player';\nimport {collides} from './utils';\n\nexport default class Collisions {\n    static handle() {\n        Hero.bullets.forEach( bullet => {\n            Blocks.data.forEach(block => {\n                if(collides(bullet, block)) {\n                    bullet.active = false;\n                    block.points -= 10000;\n                    player.score += 10000;\n                }\n            });\n        });\n    }\n}","import {CANVAS_WIDTH, CANVAS_HEIGHT, ctx} from './Canvas';\nimport Bullet from './Bullet';\nimport Block from './Block';\nimport Blocks from './Blocks';\nimport Hero from './Hero';\nimport player from './Player';\nimport Draw from './Draw';\nimport keydown from './Keydown';\nimport {addEventListeners} from './Controls';\nimport Collisions from './Collisions';\n\nfunction setup() {\n    Blocks.init();\n}\n\nfunction update() {\n    if(keydown.left) {\n        Hero.moveLeft();\n    }\n\n    if(keydown.right) {\n        Hero.moveRight();\n    }\n\n    if(keydown.space) {\n        Hero.shoot();\n    }    \n        \n    Hero.update();\n    Collisions.handle();\n    Blocks.update();\n}\n\nfunction draw() {\n    ctx.clearRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);\n    Draw.background();\n    Draw.score();\n    Hero.draw();\n    Hero.bullets.forEach(bullet => bullet.draw());\n    Blocks.draw();\n}\n\n\n// game loop\nfunction loop() {\n    // FIXME: the draw function it's called before the update. Use asynchronous methods.\n    update();\n    draw();\n    requestAnimationFrame(loop);\n}\n\nsetup();\naddEventListeners();\nrequestAnimationFrame(loop);"]}